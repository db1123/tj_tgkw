<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>基于跨域联想的概念智能生成与多维评估优化</title>
  <!-- Tailwind CSS v3 -->
 <!--  <script src="https://cdn.tailwindcss.com"></script> -->
  <!-- Font Awesome -->
 <!--  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet"> -->
  <!-- ECharts -->
<!--   <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.3.0/echarts.min.js"></script> -->
   <!-- Tailwind CSS v3 -->
 <!--  <script src="https://cdn.tailwindcss.com"></script> -->
  <!-- Font Awesome -->
 <!--  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet"> -->
  <script src="js/3.4.16"></script>
  <link href="fonts/font-awesome.min.css" rel="stylesheet">
  <!-- ECharts -->
 <!--  <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.3.0/echarts.min.js"></script> -->
  <script src="js/echarts.min.js"></script>
  <!-- 统一的 Tailwind 配置 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#0052D9',
            secondary: '#00A870',
            accent: '#FF6B00',
            dark: '#1C2B36',
            light: '#F0F5FF',
            'primary-light': '#E6F7FF',
            'secondary-light': '#E6FFED',
            'accent-light': '#FFF2E6',
            'green-primary': '#00A870',
            'green-light': '#E6FFED',
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
          },
          boxShadow: {
            'card': '0 4px 12px rgba(0, 0, 0, 0.05)',
            'card-hover': '0 8px 16px rgba(0, 0, 0, 0.1)',
          }
        }
      },
      darkMode: 'class'
    }
  </script>
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .bg-gradient-green {
        background: linear-gradient(135deg, #00A870 0%, #36D399 100%);
      }
      .text-shadow {
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .transition-all-300 {
        transition: all 300ms ease-in-out;
      }
      .scrollbar-thin {
        scrollbar-width: thin;
      }
      .scrollbar-thin::-webkit-scrollbar {
        width: 6px;
      }
      .scrollbar-thin::-webkit-scrollbar-track {
        background: #f1f1f1;
      }
      .scrollbar-thin::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 3px;
      }
      .scrollbar-thin::-webkit-scrollbar-thumb:hover {
        background: #555;
      }
    }
  </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen flex flex-col">
  <!-- 顶部导航栏 -->
  <header class="bg-white dark:bg-gray-800 shadow-md z-10">
    <div class="container mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items items-center items-center space-x-2">
        <i class="fa fa-sitemap text-primary text-2xl"></i>
        <h1 class="text-xl font-bold text-primary">知识关联挖掘与分析系统</h1>
      </div>
      <div class="flex items-center space-x-4">
        <button id="themeToggle" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-all-300">
          <i class="fa fa-moon-o dark:hidden"></i>
          <i class="fa fa-sun-o hidden dark:block"></i>
        </button>
      </div>
    </div>
  </header>

  <!-- 主要内容区域 -->
  <main class="flex-grow container mx-auto px-4 py-6 flex flex-col lg:flex-row gap-6">
    <!-- 左侧面板 -->
    <div class="lg:w-1/4 space-y-6">
      <!-- 文件上传区域 -->
      <div class="bg-white dark:bg-gray-800 rounded-xl shadow-card p-6 transition-all-300 hover:shadow-card-hover">
        <h2 class="text-lg font-semibold mb-4 flex items-center">
          <i class="fa fa-upload mr-2 text-primary"></i>文件上传
        </h2>
        <div id="dropArea" class="border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center cursor-pointer hover:border-primary dark:hover:border-primary transition-all-300">
          <i class="fa fa-cloud-upload text-4xl text-gray-400 dark:text-gray-500 mb-3"></i>
          <p class="mb-2">拖放文件到此处或点击上传</p>
          <p class="text-sm text-gray-500 dark:text-gray-400">支持 .txt, .csv, .json 格式</p>
          <input type="file" id="fileInput" class="hidden" accept=".txt,.csv,.json">
        </div>
        <div class="mt-4 flex flex-wrap gap-2">
          <button id="loadExampleBtn" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-blue-700 transition-all-300 flex items-center">
            <i class="fa fa-magic mr-2"></i>加载示例数据
          </button>
          <button id="clearDataBtn" class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-all-300 flex items-center">
            <i class="fa fa-trash mr-2"></i>清空数据
          </button>
        </div>
      </div>

      <!-- 生成图表按钮 -->
      <div class="bg-white dark:bg-gray-800 rounded-xl shadow-card p-6 transition-all-300 hover:shadow-card-hover">
        <button id="generateChartBtn" class="w-full px-4 py-3 bg-green-primary text-white rounded-lg hover:bg-green-700 transition-all-300 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed" disabled>
          <i class="fa fa-lightbulb-o mr-2"></i>生成概念生成与评估
        </button>
        <p class="text-sm text-gray-500 dark:text-gray-400 mt-3 text-center">点击生成按钮后将在右侧显示跨域联想概念生成与评估结果</p>
      </div>

      <!-- 数据结构树 -->
      <div class="bg-white dark:bg-gray-800 rounded-xl shadow-card p-6 transition-all-300 hover:shadow-card-hover">
        <h2 class="text-lg font-semibold mb-4 flex items-center">
          <i class="fa fa-tree mr-2 text-primary"></i>数据结构树
        </h2>
        <div id="dataTree" class="max-h-60 overflow-y-auto scrollbar-thin border border-gray-200 dark:border-gray-700 rounded-lg p-3">
          <p class="text-gray-500 dark:text-gray-400 text-center italic">暂无数据</p>
        </div>
      </div>

      <!-- 大文本框 -->
      <div class="bg-white dark:bg-gray-800 rounded-xl shadow-card p-6 transition-all-300 hover:shadow-card-hover">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-lg font-semibold flex items-center">
            <i class="fa fa-file-text mr-2 text-primary"></i>文本数据
          </h2>
          <div class="flex gap-2">
            <button id="copyTextBtn" class="p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-all-300 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
              <i class="fa fa-copy"></i>
            </button>
            <button id="clearTextBtn" class="p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-all-300 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
              <i class="fa fa-times"></i>
            </button>
          </div>
        </div>
        <textarea id="textData" class="w-full h-60 p-3 border border-gray-200 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-900 resize-none scrollbar-thin" placeholder="数据将显示在这里..." readonly></textarea>
      </div>
    </div>

    <!-- 右侧面板 -->
    <div class="lg:w-3/4 space-y-6">
      <!-- 标题区域 -->
      <div class="mb-4 text-center">
        <div class="inline-block px-4 py-1 bg-green-light dark:bg-green-900/30 rounded-full text-green-primary dark:text-green-300 text-sm font-medium mb-3">
          创新点2
        </div>
        <h1 class="text-2xl md:text-3xl font-bold mb-2">基于跨域联想的概念智能生成与多维评估优化</h1>
        <p class="text-gray-600 dark:text-gray-400">为企业产品研发提供从创意激发到方案优选的闭环支持</p>
      </div>

      <!-- 主要内容卡片 -->
      <div class="bg-white dark:bg-gray-800 rounded-xl shadow-card p-6 transition-all-300 hover:shadow-card-hover mb-6">
        <!-- 技术实现标签页 -->
        <div class="flex border-b border-gray-200 dark:border-gray-700 mb-6">
          <button id="techTab" class="px-6 py-3 font-medium text-green-primary border-b-2 border-green-primary">
            技术实现
          </button>
        </div>

        <!-- 内容区域 -->
        <div id="mainContentArea" class="hidden">
          <!-- 两栏布局 -->
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- 左侧 - 概念方案智能生成与优化 -->
            <div class="bg-gray-50 dark:bg-gray-900 rounded-lg p-4 lg:col-span-2">
              <h3 class="text-lg font-semibold mb-3 text-center">概念方案智能生成与优化</h3>
              <div id="conceptGeneration" class="w-full h-[500px]"></div>
              <div class="mt-4 text-center">
                <p class="text-sm text-gray-600 dark:text-gray-400">基于跨域联想的创新概念生成与优化流程</p>
              </div>
            </div>

            <!-- 右侧 - 技术实现 -->
            <div class="flex flex-col gap-6 lg:col-span-2">
              <!-- 跨域联想机制 -->
              <div class="bg-gray-50 dark:bg-gray-900 rounded-lg p-4 flex-grow">
                <h3 class="text-lg font-semibold mb-3 text-center">跨域联想机制</h3>
                <div id="crossDomainAssociation" class="w-full h-[250px]"></div>
              </div>
              
              <!-- 多维评估体系 -->
              <div class="bg-gray-50 dark:bg-gray-900 rounded-lg p-4 flex-grow">
                <h3 class="text-lg font-semibold mb-3 text-center">多维评估体系</h3>
                <div id="multiDimensionEvaluation" class="w-full h-[250px]"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- 初始提示区域 -->
        <div id="initialPromptArea" class="flex flex-col items-center justify-center py-16">
          <div class="w-24 h-24 rounded-full bg-green-light dark:bg-green-900/30 flex items-center justify-center text-green-primary mb-6">
            <i class="fa fa-lightbulb-o text-4xl"></i>
          </div>
          <h3 class="text-xl font-semibold mb-3 text-center">准备生成概念生成与评估</h3>
          <p class="text-gray-600 dark:text-gray-400 text-center max-w-md">
            请在左侧面板上传数据文件或加载示例数据，然后点击"生成概念生成与评估"按钮以显示分析结果
          </p>
        </div>
      </div>

      <!-- 数据统计卡片 -->
      <div id="statsCards" class="hidden grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-card p-6 transition-all-300 hover:shadow-card-hover">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-semibold">概念创新度提升</h3>
            <div class="w-10 h-10 rounded-full bg-green-light dark:bg-green-900/30 flex items-center justify-center text-green-primary">
              <i class="fa fa-lightbulb-o"></i>
            </div>
          </div>
          <div class="flex items-end">
            <span class="text-3xl font-bold">28%</span>
            <span class="text-gray-500 dark:text-gray-400 ml-2 mb-1">提升</span>
          </div>
          <div class="mt-2 text-sm text-gray-500 dark:text-gray-400">产品概念创新度较传统方法提升 <span class="text-green-500">28%</span></div>
        </div>
        
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-card p-6 transition-all-300 hover:shadow-card-hover">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-semibold">评估准确率提升</h3>
            <div class="w-10 h-10 rounded-full bg-green-light dark:bg-green-900/30 flex items-center justify-center text-green-primary">
              <i class="fa fa-bullseye"></i>
            </div>
          </div>
          <div class="flex items-end">
            <span class="text-3xl font-bold">20%</span>
            <span class="text-gray-500 dark:text-gray-400 ml-2 mb-1">提升</span>
          </div>
          <div class="mt-2 text-sm text-gray-500 dark:text-gray-400">方案评估准确率较传统方法提升 <span class="text-green-500">20%</span></div>
        </div>
        
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-card p-6 transition-all-300 hover:shadow-card-hover">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-semibold">专利成果</h3>
            <div class="w-10 h-10 rounded-full bg-green-light dark:bg-green-900/30 flex items-center justify-center text-green-primary">
              <i class="fa fa-certificate"></i>
            </div>
          </div>
          <div class="flex items-end">
            <span class="text-3xl font-bold">100+</span>
            <span class="text-gray-500 dark:text-gray-400 ml-2 mb-1">项</span>
          </div>
          <div class="mt-2 text-sm text-gray-500 dark:text-gray-400">已获得 <span class="text-green-500">100多项</span> 专利授权</div>
        </div>
      </div>

      <!-- 技术特点卡片 -->
      <div id="techFeaturesCard" class="hidden bg-white dark:bg-gray-800 rounded-xl shadow-card p-6 transition-all-300 hover:shadow-card-hover">
        <h2 class="text-xl font-bold mb-6 text-center">核心技术特点</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
          <div class="bg-gray-50 dark:bg-gray-900 rounded-lg p-4 text-center">
            <div class="w-12 h-12 rounded-full bg-green-light dark:bg-green-900/30 flex items-center justify-center text-green-primary mx-auto mb-3">
              <i class="fa fa-random text-xl"></i>
            </div>
            <h3 class="font-semibold mb-2">跨域知识联想</h3>
            <p class="text-sm text-gray-600 dark:text-gray-400">突破领域界限，发现不同领域间的创新关联</p>
          </div>
          
          <div class="bg-gray-50 dark:bg-gray-900 rounded-lg p-4 text-center">
            <div class="w-12 h-12 rounded-full bg-green-light dark:bg-green-900/30 flex items-center justify-center text-green-primary mx-auto mb-3">
              <i class="fa fa-cogs text-xl"></i>
            </div>
            <h3 class="font-semibold mb-2">智能概念生成</h3>
            <p class="text-sm text-gray-600 dark:text-gray-400">基于机器学习的创新概念自动生成算法</p>
          </div>
          
          <div class="bg-gray-50 dark:bg-gray-900 rounded-lg p-4 text-center">
            <div class="w-12 h-12 rounded-full bg-green-light dark:bg-green-900/30 flex items-center justify-center text-green-primary mx-auto mb-3">
              <i class="fa fa-bar-chart text-xl"></i>
            </div>
            <h3 class="font-semibold mb-2">多维评估体系</h3>
            <p class="text-sm text-gray-600 dark:text-gray-400">从技术、市场、用户等多维度评估创新方案</p>
          </div>
          
          <div class="bg-gray-50 dark:bg-gray-900 rounded-lg p-4 text-center">
            <div class="w-12 h-12 rounded-full bg-green-light dark:bg-green-900/30 flex items-center justify-center text-green-primary mx-auto mb-3">
              <i class="fa fa-refresh text-xl"></i>
            </div>
            <h3 class="font-semibold mb-2">迭代优化机制</h3>
            <p class="text-sm text-gray-600 dark:text-gray-400">基于反馈的创新方案持续优化与改进</p>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- 页脚 -->
  <footer class="bg-white dark:bg-gray-800 shadow-inner py-4">
    <div class="container mx-auto px-4 text-center text-gray-600 dark:text-gray-400 text-sm">
      <p>© 2025 知识关联挖掘与分析系统 | 设计与开发</p>
    </div>
  </footer>

  <!-- 通知组件 -->
  <div id="notification" class="fixed top-4 right-4 max-w-sm bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4 transform translate-x-full transition-transform duration-300 flex items-start z-50">
    <div id="notificationIcon" class="text-xl mr-3"></div>
    <div class="flex-1">
      <h3 id="notificationTitle" class="font-semibold"></h3>
      <p id="notificationMessage" class="text-sm text-gray-600 dark:text-gray-400 mt-1"></p>
    </div>
    <button id="closeNotification" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
      <i class="fa fa-times"></i>
    </button>
  </div>

  <script>
    // DOM元素 - 左侧文件上传相关
    const dropArea = document.getElementById('dropArea');
    const fileInput = document.getElementById('fileInput');
    const loadExampleBtn = document.getElementById('loadExampleBtn');
    const clearDataBtn = document.getElementById('clearDataBtn');
    const generateChartBtn = document.getElementById('generateChartBtn');
    const dataTree = document.getElementById('dataTree');
    const textData = document.getElementById('textData');
    const copyTextBtn = document.getElementById('copyTextBtn');
    const clearTextBtn = document.getElementById('clearTextBtn');
    
    // DOM元素 - 右侧知识关联相关
    const themeToggle = document.getElementById('themeToggle');
    const techTab = document.getElementById('techTab');
    const effectTab = document.getElementById('effectTab');
    const mainContentArea = document.getElementById('mainContentArea');
    const initialPromptArea = document.getElementById('initialPromptArea');
    const statsCards = document.getElementById('statsCards');
    const techFeaturesCard = document.getElementById('techFeaturesCard');
    
    // DOM元素 - 图表容器
    const conceptGeneration = document.getElementById('conceptGeneration');
    const crossDomainAssociation = document.getElementById('crossDomainAssociation');
    const multiDimensionEvaluation = document.getElementById('multiDimensionEvaluation');
    
    // DOM元素 - 通知组件
    const notification = document.getElementById('notification');
    const notificationIcon = document.getElementById('notificationIcon');
    const notificationTitle = document.getElementById('notificationTitle');
    const notificationMessage = document.getElementById('notificationMessage');
    const closeNotification = document.getElementById('closeNotification');

    // 全局变量
    let processedData = {
      dates: [],
      values: [],
      raw: ''
    };
    let conceptGenerationChart = null;
    let crossDomainAssociationChart = null;
    let multiDimensionEvaluationChart = null;

    // 初始化
    document.addEventListener('DOMContentLoaded', () => {
      // 初始化主题
      initTheme();
      
      // 初始化事件监听
      initEventListeners();
    });

    // 初始化主题
    function initTheme() {
      if (localStorage.getItem('theme') === 'dark' || 
          (!localStorage.getItem('theme') && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        document.documentElement.classList.add('dark');
      } else {
        document.documentElement.classList.remove('dark');
      }
    }

    // 初始化事件监听
    function initEventListeners() {
      // 主题切换
      themeToggle.addEventListener('click', toggleTheme);
      
      // 标签页切换（仅使用，保留以保持代码兼容性）
      techTab.addEventListener('click', () => {});
      
      // 文件上传区域事件
      dropArea.addEventListener('click', () => fileInput.click());
      dropArea.addEventListener('dragover', handleDragOver);
      dropArea.addEventListener('drop', handleDrop);
      fileInput.addEventListener('change', handleFileSelect);
      
      // 按钮事件
      loadExampleBtn.addEventListener('click', loadExampleData);
      clearDataBtn.addEventListener('click', clearData);
      generateChartBtn.addEventListener('click', generateCharts);
      copyTextBtn.addEventListener('click', copyTextToClipboard);
      clearTextBtn.addEventListener('click', clearTextArea);
      
      // 通知关闭按钮
      closeNotification.addEventListener('click', hideNotification);
    }

    // 切换主题
    function toggleTheme() {
      if (document.documentElement.classList.contains('dark')) {
        document.documentElement.classList.remove('dark');
        localStorage.setItem('theme', 'light');
      } else {
        document.documentElement.classList.add('dark');
        localStorage.setItem('theme', 'dark');
      }
      
      // 如果图表已生成，重新初始化以适应新主题
      if (conceptGenerationChart && crossDomainAssociationChart && multiDimensionEvaluationChart) {
        initConceptGenerationChart();
        initCrossDomainAssociationChart();
        initMultiDimensionEvaluationChart();
      }
    }

    // 处理拖拽经过
    function handleDragOver(e) {
      e.preventDefault();
      dropArea.classList.add('border-primary');
    }

    // 处理拖拽放置
    function handleDrop(e) {
      e.preventDefault();
      dropArea.classList.remove('border-primary');
      
      if (e.dataTransfer.files.length) {
        handleFiles(e.dataTransfer.files);
      }
    }

    // 处理文件选择
    function handleFileSelect(e) {
      if (e.target.files.length) {
        handleFiles(e.target.files);
      }
    }

    // 处理文件
    function handleFiles(files) {
      const file = files[0];
      
      // 验证文件类型
      if (!['text/plain', 'text/csv', 'application/json'].includes(file.type) &&
          !file.name.endsWith('.txt') && !file.name.endsWith('.csv') && !file.name.endsWith('.json')) {
        showNotification('错误', '请上传.txt, .csv或.json格式的文件', 'error');
        return;
      }
      
      const reader = new FileReader();
      
      reader.onload = function(e) {
        try {
          const content = e.target.result;
          processedData.raw = content;
          
          // 解析文件内容
          parseFileContent(file, content);
          
          // 更新UI
          updateDataTree();
          updateTextArea();
          
          // 启用按钮
          copyTextBtn.disabled = false;
          clearTextBtn.disabled = false;
          generateChartBtn.disabled = false;
          
          showNotification('成功', '文件上传并解析成功', 'success');
        } catch (error) {
          showNotification('错误', `文件解析失败: ${error.message}`, 'error');
        }
      };
      
      reader.onerror = function() {
        showNotification('错误', '文件读取失败', 'error');
      };
      
      reader.readAsText(file);
    }

    // 解析文件内容
    function parseFileContent(file, content) {
      if (file.name.endsWith('.txt')) {
        // 解析TXT文件（每行一个数据点，格式：日期,数值）
        const lines = content.split('\n').filter(line => line.trim() !== '');
        processedData.dates = [];
        processedData.values = [];
        
        lines.forEach(line => {
          const parts = line.split(',');
          if (parts.length === 2) {
            processedData.dates.push(parts[0].trim());
            processedData.values.push(parseFloat(parts[1].trim()));
          }
        });
        
        if (processedData.dates.length === 0) {
          throw new Error('TXT文件格式不正确，请确保每行格式为：日期,数值');
        }
      } else if (file.name.endsWith('.csv')) {
        // 解析CSV文件（第一行为标题，后续行为数据）
        const lines = content.split('\n').filter(line => line.trim() !== '');
        if (lines.length < 2) {
          throw new Error('CSV文件至少需要包含标题行和一行数据');
        }
        
        // 假设第一列为日期，第二列为数值
        processedData.dates = [];
        processedData.values = [];
        
        for (let i = 1; i < lines.length; i++) {
          const parts = lines[i].split(',');
          if (parts.length >= 2) {
            processedData.dates.push(parts[0].trim());
            processedData.values.push(parseFloat(parts[1].trim()));
          }
        }
        
        if (processedData.dates.length === 0) {
          throw new Error('CSV文件格式不正确，请确保包含日期和数值列');
        }
      } else if (file.name.endsWith('.json')) {
        // 解析JSON文件（格式：{ "dates": [], "values": [] }）
        const jsonData = JSON.parse(content);
        
        if (!jsonData.dates || !jsonData.values || !Array.isArray(jsonData.dates) || !Array.isArray(jsonData.values)) {
          throw new Error('JSON文件格式不正确，请确保包含dates和values数组');
        }
        
        if (jsonData.dates.length !== jsonData.values.length) {
          throw new Error('dates和values数组长度必须一致');
        }
        
        processedData.dates = jsonData.dates;
        processedData.values = jsonData.values.map(v => parseFloat(v));
      } else {
        throw new Error('不支持的文件格式');
      }
    }

    // 加载示例数据
    function loadExampleData() {
      // 生成过去30天的示例数据
      const today = new Date();
      processedData.dates = [];
      processedData.values = [];
      
      for (let i = 29; i >= 0; i--) {
        const date = new Date(today);
        date.setDate(today.getDate() - i);
        processedData.dates.push(date.toISOString().split('T')[0]);
        
        // 生成随机数值，带有一定的趋势性
        const trend = i * 0.5; // 整体上升趋势
        const random = Math.random() * 10; // 随机波动
        processedData.values.push(Math.round((20 + trend + random) * 10) / 10);
      }
      
      // 生成原始数据文本
      processedData.raw = processedData.dates.map((date, index) => `${date},${processedData.values[index]}`).join('\n');
      
      // 更新UI
      updateDataTree();
      updateTextArea();
      
      // 启用按钮
      copyTextBtn.disabled = false;
      clearTextBtn.disabled = false;
      generateChartBtn.disabled = false;
      
      showNotification('示例数据已加载', '数据已显示在文本区域和结构树中', 'success');
    }

    // 清空数据
    function clearData() {
      // 清空数据
      processedData = {
        dates: [],
        values: [],
        raw: ''
      };
      
      // 更新UI
      updateDataTree();
      updateTextArea();
      
      // 禁用按钮
      copyTextBtn.disabled = true;
      clearTextBtn.disabled = true;
      generateChartBtn.disabled = true;
      
      // 隐藏图表和相关内容
      if (conceptGenerationChart) {
        conceptGenerationChart.dispose();
        conceptGenerationChart = null;
      }
      
      if (crossDomainAssociationChart) {
        crossDomainAssociationChart.dispose();
        crossDomainAssociationChart = null;
      }
      
      if (multiDimensionEvaluationChart) {
        multiDimensionEvaluationChart.dispose();
        multiDimensionEvaluationChart = null;
      }
      
      mainContentArea.classList.add('hidden');
      initialPromptArea.classList.remove('hidden');
      statsCards.classList.add('hidden');
      techFeaturesCard.classList.add('hidden');
      
      showNotification('数据已清空', '', 'info');
    }

    // 生成图表
    function generateCharts() {
      if (processedData.dates.length === 0 || processedData.values.length === 0) {
        showNotification('错误', '没有可用的数据生成图表', 'error');
        return;
      }
      
      // 显示图表区域，隐藏初始提示
      mainContentArea.classList.remove('hidden');
      initialPromptArea.classList.add('hidden');
      statsCards.classList.remove('hidden');
      techFeaturesCard.classList.remove('hidden');
      
      // 初始化图表
      initConceptGenerationChart();
      initCrossDomainAssociationChart();
      initMultiDimensionEvaluationChart();
      
      showNotification('图表生成成功', '概念生成与评估分析已显示在右侧', 'success');
    }

    // 更新数据结构树
    function updateDataTree() {
      if (processedData.dates.length === 0 || processedData.values.length === 0) {
        dataTree.innerHTML = '<p class="text-gray-500 dark:text-gray-400 text-center italic">暂无数据</p>';
        return;
      }
      
      // 创建数据树
      let treeHTML = `
        <div class="tree-item">
          <div class="flex items-center cursor-pointer tree-toggle">
            <i class="fa fa-folder-open text-yellow-500 mr-2"></i>
            <span>数据</span>
          </div>
          <div class="ml-6 mt-2">
      `;
      
      // 添加日期节点
      treeHTML += `
        <div class="tree-item">
          <div class="flex items-center cursor-pointer tree-toggle">
            <i class="fa fa-calendar text-blue-500 mr-2"></i>
            <span>日期 (${processedData.dates.length})</span>
          </div>
          <div class="ml-6 mt-2">
      `;
      
      // 添加前5个日期作为示例
      const datesToShow = processedData.dates.slice(0, 5);
      datesToShow.forEach(date => {
        treeHTML += `
          <div class="tree-item">
            <div class="flex items-center">
              <i class="fa fa-calendar-o text-gray-500 mr-2"></i>
              <span>${date}</span>
            </div>
          </div>
        `;
      });
      
      // 如果有更多日期，显示省略号
      if (processedData.dates.length > 5) {
        treeHTML += `
          <div class="tree-item">
            <div class="flex items-center text-gray-500">
              <i class="fa fa-ellipsis-h mr-2"></i>
              <span>还有 ${processedData.dates.length - 5} 个日期...</span>
            </div>
          </div>
        `;
      }
      
      treeHTML += `
          </div>
        </div>
      `;
      
      // 添加数值节点
      treeHTML += `
        <div class="tree-item">
          <div class="flex items-center cursor-pointer tree-toggle">
            <i class="fa fa-line-chart text-green-500 mr-2"></i>
            <span>数值 (${processedData.values.length})</span>
          </div>
          <div class="ml-6 mt-2">
      `;
      
      // 添加前5个数值作为示例
      const valuesToShow = processedData.values.slice(0, 5);
      valuesToShow.forEach(value => {
        treeHTML += `
          <div class="tree-item">
            <div class="flex items-center">
              <i class="fa fa-circle text-xs text-gray-500 mr-2"></i>
              <span>${value}</span>
            </div>
          </div>
        `;
      });
      
      // 如果有更多数值，显示省略号
      if (processedData.values.length > 5) {
        treeHTML += `
          <div class="tree-item">
            <div class="flex items-center text-gray-500">
              <i class="fa fa-ellipsis-h mr-2"></i>
              <span>还有 ${processedData.values.length - 5} 个数值...</span>
            </div>
          </div>
        `;
      }
      
      treeHTML += `
          </div>
        </div>
      `;
      
      treeHTML += `
          </div>
        </div>
      `;
      
      dataTree.innerHTML = treeHTML;
      
      // 添加树节点展开/折叠功能
      document.querySelectorAll('.tree-toggle').forEach(toggle => {
        toggle.addEventListener('click', function() {
          const content = this.nextElementSibling;
          const icon = this.querySelector('i');
          
          if (content.style.display === 'none') {
            content.style.display = 'block';
            icon.classList.remove('fa-folder');
            icon.classList.add('fa-folder-open');
          } else {
            content.style.display = 'none';
            icon.classList.remove('fa-folder-open');
            icon.classList.add('fa-folder');
          }
        });
      });
    }

    // 更新文本区域
    function updateTextArea() {
      textData.value = processedData.raw || '暂无数据';
    }

    // 复制文本到剪贴板
    function copyTextToClipboard() {
      if (!processedData.raw) {
        showNotification('提示', '没有可复制的文本', 'info');
        return;
      }
      
      textData.select();
      document.execCommand('copy');
      
      showNotification('成功', '文本已复制到剪贴板', 'success');
    }

    // 清空文本区域
    function clearTextArea() {
      textData.value = '';
      showNotification('提示', '文本区域已清空', 'info');
    }

    // 初始化概念方案智能生成与优化图表
    function initConceptGenerationChart() {
      // 初始化ECharts实例
      conceptGenerationChart = echarts.init(conceptGeneration);
      
      // 监听窗口大小变化，调整图表大小
      window.addEventListener('resize', () => {
        conceptGenerationChart.resize();
      });
      
      // 图表配置
      const option = {
        backgroundColor: 'transparent',
        tooltip: {
          trigger: 'item',
          formatter: '{b}: {c}'
        },
        legend: {
          orient: 'vertical',
          right: 10,
          top: 'center',
          data: ['需求分析', '跨域联想', '概念生成', '方案评估', '优化迭代'],
          textStyle: {
            color: document.documentElement.classList.contains('dark') ? '#e2e8f0' : '#1a202c'
          }
        },
        series: [
          {
            name: '概念生成流程',
            type: 'pie',
            radius: ['40%', '70%'],
            avoidLabelOverlap: false,
            itemStyle: {
              borderRadius: 10,
              borderColor: document.documentElement.classList.contains('dark') ? '#1f2937' : '#ffffff',
              borderWidth: 2
            },
            label: {
              show: false,
              position: 'center'
            },
            emphasis: {
              label: {
                show: true,
                fontSize: '18',
                fontWeight: 'bold',
                color: document.documentElement.classList.contains('dark') ? '#e2e8f0' : '#1a202c'
              }
            },
            labelLine: {
              show: false
            },
            data: [
              { value: 25, name: '需求分析', itemStyle: { color: '#00A870' } },
              { value: 30, name: '跨域联想', itemStyle: { color: '#36D399' } },
              { value: 20, name: '概念生成', itemStyle: { color: '#68D391' } },
              { value: 15, name: '方案评估', itemStyle: { color: '#9AE6B4' } },
              { value: 10, name: '优化迭代', itemStyle: { color: '#C6F6D5' } }
            ]
          }
        ]
      };
      
      // 设置图表
      conceptGenerationChart.setOption(option);
    }

    // 初始化跨域联想机制图表
    function initCrossDomainAssociationChart() {
      // 初始化ECharts实例
      crossDomainAssociationChart = echarts.init(crossDomainAssociation);
      
      // 监听窗口大小变化，调整图表大小
      window.addEventListener('resize', () => {
        crossDomainAssociationChart.resize();
      });
      
      // 图表配置
      const option = {
        backgroundColor: 'transparent',
        tooltip: {},
        legend: {
          data: ['领域A', '领域B', '领域C', '领域D', '关联度'],
          bottom: 0,
          textStyle: {
            color: document.documentElement.classList.contains('dark') ? '#e2e8f0' : '#1a202c'
          }
        },
        series: [
          {
            type: 'graph',
            layout: 'force',
            animation: true,
            label: {
              show: true,
              position: 'right',
              formatter: '{b}',
              color: document.documentElement.classList.contains('dark') ? '#e2e8f0' : '#1a202c'
            },
            draggable: true,
            data: [
              {
                name: '机械设计',
                symbolSize: 50,
                itemStyle: {
                  color: '#00A870'
                }
              },
              {
                name: '材料科学',
                symbolSize: 40,
                itemStyle: {
                  color: '#36D399'
                }
              },
              {
                name: '人工智能',
                symbolSize: 45,
                itemStyle: {
                  color: '#68D391'
                }
              },
              {
                name: '生物医学',
                symbolSize: 35,
                itemStyle: {
                  color: '#9AE6B4'
                }
              },
              {
                name: '能源技术',
                symbolSize: 38,
                itemStyle: {
                  color: '#C6F6D5'
                }
              }
            ],
            links: [
              {
                source: '机械设计',
                target: '材料科学',
                lineStyle: {
                  width: 5,
                  color: '#36D399'
                }
              },
              {
                source: '机械设计',
                target: '人工智能',
                lineStyle: {
                  width: 8,
                  color: '#68D391'
                }
              },
              {
                source: '材料科学',
                target: '生物医学',
                lineStyle: {
                  width: 6,
                  color: '#9AE6B4'
                }
              },
              {
                source: '人工智能',
                target: '生物医学',
                lineStyle: {
                  width: 7,
                  color: '#C6F6D5'
                }
              },
              {
                source: '生物医学',
                target: '能源技术',
                lineStyle: {
                  width: 4,
                  color: '#00A870'
                }
              },
              {
                source: '能源技术',
                target: '机械设计',
                lineStyle: {
                  width: 3,
                  color: '#36D399'
                }
              }
            ],
            lineStyle: {
              opacity: 0.9,
              width: 2,
              curveness: 0.2
            }
          }
        ]
      };
      
      // 设置图表
      crossDomainAssociationChart.setOption(option);
    }

    // 初始化多维评估体系图表
    function initMultiDimensionEvaluationChart() {
      // 初始化ECharts实例
      multiDimensionEvaluationChart = echarts.init(multiDimensionEvaluation);
      
      // 监听窗口大小变化，调整图表大小
      window.addEventListener('resize', () => {
        multiDimensionEvaluationChart.resize();
      });
      
      // 图表配置
      const option = {
        backgroundColor: 'transparent',
        tooltip: {
          trigger: 'axis',
          axisPointer: {
            type: 'shadow'
          }
        },
        legend: {
          data: ['技术可行性', '市场潜力', '创新性', '用户价值', '成本效益'],
          bottom: 0,
          textStyle: {
            color: document.documentElement.classList.contains('dark') ? '#e2e8f0' : '#1a202c'
          }
        },
        radar: [
          {
            indicator: [
              { text: '技术可行性', max: 100 },
              { text: '市场潜力', max: 100 },
              { text: '创新性', max: 100 },
              { text: '用户价值', max: 100 },
              { text: '成本效益', max: 100 }
            ],
            center: ['50%', '50%'],
            radius: '70%',
            axisLine: {
              lineStyle: {
                color: document.documentElement.classList.contains('dark') ? '#e2e8f0' : '#1a202c'
              }
            },
            splitLine: {
              lineStyle: {
                color: document.documentElement.classList.contains('dark') ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)'
              }
            },
            axisLabel: {
              color: document.documentElement.classList.contains('dark') ? '#e2e8f0' : '#1a202c'
            }
          }
        ],
        series: [
          {
            name: '方案评估',
            type: 'radar',
            data: [
              {
                value: [85, 90, 95, 80, 75],
                name: '概念方案A',
                itemStyle: {
                  color: '#00A870'
                },
                lineStyle: {
                  color: '#00A870'
                },
                areaStyle: {
                  color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                    {
                      offset: 0,
                      color: 'rgba(0, 168, 112, 0.5)'
                    },
                    {
                      offset: 1,
                      color: 'rgba(0, 168, 112, 0.1)'
                    }
                  ])
                }
              },
              {
                value: [70, 85, 80, 90, 95],
                name: '概念方案B',
                itemStyle: {
                  color: '#36D399'
                },
                lineStyle: {
                  color: '#36D399'
                },
                areaStyle: {
                  color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                    {
                      offset: 0,
                      color: 'rgba(54, 211, 153, 0.5)'
                    },
                    {
                      offset: 1,
                      color: 'rgba(54, 211, 153, 0.1)'
                    }
                  ])
                }
              }
            ]
          }
        ]
      };
      
      // 设置图表
      multiDimensionEvaluationChart.setOption(option);
    }

    // 显示通知
    function showNotification(title, message, type = 'info') {
      // 设置通知类型
      let iconClass = 'fa-info-circle text-info';
      if (type === 'success') {
        iconClass = 'fa-check-circle text-success';
      } else if (type === 'error') {
        iconClass = 'fa-exclamation-circle text-danger';
      } else if (type === 'warning') {
        iconClass = 'fa-exclamation-triangle text-warning';
      }
      
      // 设置通知内容
      notificationIcon.className = iconClass;
      notificationTitle.textContent = title;
      notificationMessage.textContent = message;
      
      // 显示通知
      notification.classList.remove('translate-x-full');
      
      // 3秒后自动隐藏
      setTimeout(hideNotification, 3000);
    }

    // 隐藏通知
    function hideNotification() {
      notification.classList.add('translate-x-full');
    }
  </script>
</body>
</html>
