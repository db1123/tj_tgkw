<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
    <meta http-equiv="Cache-Control" content="no-siteapp"/>
    <!--_global 公共配置文件 -->
    <script language="javascript">var golbal_type = "admin";</script>
    <script type="text/javascript" src="/javascript/global.js"></script><!--/_global 公共配置文件-->

    <script type="text/javascript" src="/module/capability/ability/huaxiang/js/jQuery.Huifold.js"></script>
</head>
<style type="text/css">
    .popup {
        display: none;
        position: fixed;
        top: 0;
        right: 0;
        height: 100%;
        width: 27%;
        background-color: #fff;
        box-shadow: -2px 0px 10px rgba(0, 0, 0, 0.2);
        z-index: 1000;
        overflow-y: auto;
        padding: 20px;
    }

    .popup.active {
        display: block;
    }

    .close-btn {
        float: right;
        font-size: 24px;
        font-weight: bold;
        text-decoration: none;
        color: #333;
    }

    .close-btn:hover {
        color: #000;
    }

    .rowtop{
        margin-top: 10px;
    }
</style>
<body>
<div class="page-container">
    <div id="huaxiang">

    </div>
    <div id="right-popup" class="popup">
        <a href="" id="close-popup-btn" class="close-btn">&times;</a>
        <h4>能力详情</h4>
        <div class="row cl rowtop">
            <label class="form-label col-xs-4 col-sm-3" style="font-weight: bold;"><span
                    class="c-red">*</span>能力类型：</label>
            <div class="formControls col-xs-8 col-sm-9">
                <label class="form-label" id="FTypeName" style="width: 100%;text-align: left;"></label>
            </div>
        </div>
        <div class="row cl rowtop">
            <label class="form-label col-xs-4 col-sm-3" style="font-weight: bold;"><span
                    class="c-red">*</span>能力名称：</label>
            <div class="formControls col-xs-8 col-sm-9">
                <label class="form-label" id="FName"
                       style="width: 100%;text-align: left;"></label>
            </div>
        </div>
        <div class="row cl rowtop">
            <label class="form-label col-xs-4 col-sm-3" style="font-weight: bold;"><span
                    class="c-red">*</span>能力描述：</label>
            <div class="formControls col-xs-8 col-sm-9">
                <label class="form-label" id="FNote"
                       style="width: 100%;text-align: left;"></label>
            </div>
        </div>
<!--        <div>-&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;</div>-->
        <h4>能力水平</h4>
        <div id="nenglidengji">

        </div>
    </div>
</div>
<script type="text/javascript">
    var ftype = getQueryStringByName('ftype');//1=全部 2=个人
    var userid;
    // 业务代码
    $(function () {
        if (ftype == 2) {
            userid = getQueryStringByName('userid');
        }
        $.ajax({
            type: 'POST',
            contentType: 'application/json',
            url: '/s/ability/getabilityhuaxiang', // 调用地址
            data: JSON.stringify({
                ftype: ftype,
                userid: userid
            }),
            async: false,
            success: function (data) {
                var html = "";
                var html1 = "";
                var huaxiang = $("#huaxiang");
                huaxiang.empty();
                html = `<ul id="Huifold1" class="Huifold">`;
                for (var i = 0; i < data.type_Array.length; i++) {
                    html1 += `<li class="item">`;
                    html1 += `    <h4>` + data.type_Array[i].FName + `<b>+</b></h4>`;
                    html1 += `    <div class="info"> `;
                    html1 += `        <div class="Hui-tags-has">`;
                    for (var j = 0; j < data.ability_Array.length; j++) {
                        if (data.ability_Array[j].i == i) {
                            html1 += `        <span onclick="selectinfo(\'`+data.ability_Array[j].key+`\')">` + data.ability_Array[j].FName + `</span>`;
                        } else {
                            continue;
                        }
                    }
                    html1 += `        </div>`;
                    html1 += `    </div>`;
                    html1 += `</li>`;
                }
                html += html1 + `</ul>`;
                huaxiang.append(html);

                $("#Huifold1").Huifold({
                    item: '.item',
                    titCell: 'h4',
                    mainCell: '.info',
                    type: 3,
                    trigger: 'click',
                    className: "selected",
                    speed: "first",
                    openKeys: data.openKeys //[0, 1, 2] data.openKeys
                });

            },
            error: function (e) {
                toastr.error(e.status);
                toastr.error(e.responseText);
            }
        });
    });

    function selectinfo(fkeyid) {
        $.ajax({
            type: 'POST',
            contentType: 'application/json',
            url: '/s/ability/queryabilityInfohua', // 调用地址
            data: JSON.stringify({
                id: fkeyid
            }),
            async: false,
            success: function (data) {
                $("#FName").text(data.info.FName);
                $("#FNote").text(data.info.FNote);
                $("#FTypeName").text(data.info.FTypeName);

                if (data.info.abilityLevel.length > 0) {
                    var html1 ="";
                    for (var i = 0; i < data.info.abilityLevel.length; i++) {
                        html1 +=` <div class="row cl">
                                    <label class="form-label col-xs-3 col-sm-3" style="font-weight: bold;"><span
                                        class="c-red">*</span>名称：</label>
                                    <div class="formControls col-xs-3 col-sm-3">
                                        <label class="form-label" style="width: 100%;text-align: left;">`+data.info.abilityLevel[i].FName+`</label>
                                    </div>
                                    <label class="form-label col-xs-3 col-sm-3" style="font-weight: bold;"><span
                                        class="c-red">*</span>难度积分：</label>
                                    <div class="formControls col-xs-3 col-sm-3">
                                        <label class="form-label" style="width: 100%;text-align: left;">`+data.info.abilityLevel[i].FPoints+`</label>
                                    </div>
                                </div>`
                        html1 +=`<div class="row cl rowtop">
                                    <label class="form-label col-xs-4 col-sm-3" style="font-weight: bold;"><span
                                            class="c-red">*</span>描述：</label>
                                    <div class="formControls col-xs-8 col-sm-9">
                                        <label class="form-label" id="FNote"
                                               style="width: 100%;text-align: left;">`+data.info.abilityLevel[i].FNote+`</label>
                                    </div>
                                </div>`
                        html1 +=`<div style="height: 1px; background-color: #000; margin: 20px 0;"></div>`;
                    }
                    var nenglidengji = $("#nenglidengji");
                    nenglidengji.empty();
                    nenglidengji.append(html1);
                }
                var popup = document.getElementById('right-popup');
                popup.classList.add('active');
            },
            error: function (e) {
                toastr.error(e.status);
                toastr.error(e.responseText);
            }
        });

    }

    document.addEventListener('DOMContentLoaded', function () {
        var closePopupBtn = document.getElementById('close-popup-btn');
        var popup = document.getElementById('right-popup');

        closePopupBtn.addEventListener('click', function (e) {
            e.preventDefault();
            popup.classList.remove('active');
        });
    });

</script>
</body>
</html>