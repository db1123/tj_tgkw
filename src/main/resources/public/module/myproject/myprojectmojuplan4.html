<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="renderer" content="webkit|ie-comp|ie-stand">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport"
              content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
        <meta http-equiv="Cache-Control" content="no-siteapp"/>
        <!--_global 公共配置文件 -->
        <script language="javascript">var golbal_type = "admin";</script>
        <script type="text/javascript" src="/javascript/global.js"></script><!--/_global 公共配置文件-->
        <!--_only 独立样式 -->
        <link rel="stylesheet" href="/plugins/select2/css/select2.min.css">
        <link rel="stylesheet" href="/plugins/select2-ztree/bootstrapStyle.css"/>
        <link rel="stylesheet" href="/plugins/jquery-jsonview/jquery.jsonview.css"/>
        <link rel="stylesheet" href="/nui-ad/lib/zTree/v3/css/zTreeStyle/zTreeStyle.css"/>
        <link rel="stylesheet" href="/nui-ad/lib/datatables/1.10.15/styling/base_style/jquery.dataTables.min.css">
        <!--        <link rel="stylesheet" href="/module/myproject/css/buttons.dataTables.min.css">-->
        <!--        <link rel="stylesheet" href="/module/myproject/css/select.dataTables.min.css">-->
        <!--        <link rel="stylesheet" href="/module/myproject/css/dataTables.dateTime.min.css">-->
        <!--        <link rel="stylesheet" href="/module/myproject/css/editor.dataTables.min.css">-->
        <link rel="stylesheet" href="/plugins/daterangepicker/daterangepicker.css">
        <!--/_only 独立样式 -->
    </head>
    <style type="text/css">
        .open-work-control2 {
            white-space: nowrap;
            width: 500px;
        }
    </style>
    <body>
        <div class="page-container" style="padding: 2px;">
            <div class="f-l text-l">
                <button type="button" class="btn btn-default size-S my-btn" onclick="Values(1)"><i
                        class=" fa fa-user-plus"></i> 录入模具计划
                </button>
                <button type="button" class="btn btn-default size-S my-btn" onclick="Daochu()"><i class="fa fa-download"
                                                                                                  aria-hidden="true"/></i>
                    导出模具计划
                </button>
            </div>
            <div class="f-r text-r">

                <input type="text" class="input-text size-S form-text-FNo" style="width:200px" placeholder="制号">
                <input type="text" class="input-text size-S form-text-FPurNo" style="width:200px" placeholder="工序号">
                <input type="text" class="input-text size-S form-text-FPurName" style="width:200px" placeholder="工序名称">
                <button type="button" class="btn btn-default size-S my-btn btn-search-fun"><i class="Hui-iconfont">&#xe665;</i>
                    搜索
                </button>
            </div>
            <div class="f-l divtable" style="width: 100%; margin-top: 3px;">
                <table id="mainTable" class="display compact" style="width: 99.8%;">
                    <thead>
                        <tr>
                            <th rowspan="2" style="white-space: nowrap;">项目名称</th>
                            <th rowspan="2" style="white-space: nowrap;">制号</th>
                            <th rowspan="2" style="white-space: nowrap;">工序号</th>
                            <th rowspan="2" style="white-space: nowrap;">工序名称</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：启动</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：设计依据</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：结构会签</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：实型图</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：实型完成</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：正式图</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：编程依据（加工依据）</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：铸铁件</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划: 铸钢件</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：粗加工编程（粗程序）</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：数控编程（精编程）</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：部件依据</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：机装件采购</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：钳装件采购</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：锻件采购</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：部件加工</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：粗加工（一次粗）</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：机械加工（二次精）</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：模具装配（合模到底）</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：模具单初（研配）</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：调试自检（第三轮整改）</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：预验收时间</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：整理待发</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：签收</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：母线适配</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：品质提升</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：批量验证</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：终验收</th>
                            <th colspan="3" style="white-space: nowrap;text-align: center;">模具计划：质保期</th>
                        </tr>
                        <tr>
                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>

                            <th style="white-space: nowrap;text-align: center;">客户计划</th>
                            <th style="white-space: nowrap;text-align: center;">调整计划</th>
                            <th style="white-space: nowrap;text-align: center;">实际完成</th>


                        </tr>
                    </thead>
                </table>
            </div>
        </div>
        <script type="text/javascript" src="/nui-ad/lib/zTree/v3/js/jquery.ztree.all-3.5.min.js"></script>
        <script type="text/javascript" src="/nui-ad/lib/zTree/v3/js/jquery.ztree.exhide-3.5.min.js"></script>
        <script type="text/javascript" src="/plugins/select2/js/select2.full.min.js"></script>
        <script type="text/javascript" src="/plugins/select2-ztree/select2-ztree.js"></script>
        <script type="text/javascript" src="/plugins/select2-ztree/select2-ztree-search.js"></script>
        <script type="text/javascript" src="/plugins/jquery-jsonview/jquery.jsonview.js"></script>
        <script src="/plugins/select2/js/select2.full.min.js"></script>
        <script type="text/javascript" src="/nui-ad/lib/datatables/1.10.15/jquery.dataTables.min.js"></script>
        <script type="text/javascript" src="/javascript/dataTables.fixedColumns.min.js"></script>

        <!--        <script type="text/javascript" src="/javascript/dataTables.buttons.min.js"></script>-->
        <!--        <script type="text/javascript" src="/javascript/dataTables.select.min.js"></script>-->
        <!--        <script type="text/javascript" src="/javascript/dataTables.dateTime.min.js"></script>-->
        <!--        <script type="text/javascript" src="/javascript/dataTables.editor.min.js"></script>-->
        <script type="text/javascript" src="/plugins/moment/moment.min.js"></script>
        <script type="text/javascript" src="/plugins/daterangepicker/daterangepicker.js"></script>

        <script type="text/javascript">
            var id = getQueryStringByName('id'); // 项目ID
            var jmname = getQueryStringByName('jmname'); // 加密项目名称
            var xmname = parent.xmname; //项目名称
            var pfstate = -1;
            var showtype = getQueryStringByName('showtype'); //显示类型 1=项目管理 2=项目执行 3=项目预警
            var editor;
            var oTable;
            // 业务代码
            $(function () {
                // 封装表格

                // editor = new $.fn.dataTable.Editor({
                //     table: "#mainTable",
                //     fields: [
                //         {
                //             label: "FKHDate1", name: "客户计划", type: "datetime",
                //             def: function () { return new Date(); },
                //             fieldInfo: '请选择时间',
                //             keyInput: false, //禁止用户手动输入
                //         },
                //         {
                //             label: "FTZDate1", name: "调整计划", type: "datetime",
                //             def: function () { return new Date(); },
                //             fieldInfo: '请选择时间',
                //             keyInput: false, //禁止用户手动输入
                //         },
                //         {
                //             label: "FSJDate1", name: "实际计划", type: "datetime",
                //             def: function () { return new Date(); },
                //             fieldInfo: '请选择时间',
                //             keyInput: false, //禁止用户手动输入
                //         },
                //
                //     ],
                //     i18n: {
                //         error: {
                //             system: "服务器或网络发生错误,请联系系统管理员或稍后再试..."
                //         },
                //         datetime: {
                //             previous: '上一页',
                //             next: '下一页',
                //             months: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'],
                //             weekdays: ['星期一', '星期二', '星期三', '星期四', '星期五', '星期六', '星期天']
                //         }
                //     }
                // });


                oTable = $('#mainTable').DataTable({
                    processing: true,
                    serverSide: true,
                    fixedColumns: true,
                    fixedColumns: {
                        left: 4
                    },
                    ajax: {
                        type: 'POST',
                        contentType: 'application/json',
                        url: '/s/projectmjplan/queryprojectmjplan', // 调用地址
                        data: function (d) {
                            return JSON.stringify($.extend({}, d, {
                                page: d.start / d.length + 1, // 当前页
                                results: d.length, // 每页显示条数
                                FProjectID: id,
                                FNo: $('.form-text-FNo').val(),//制号
                                FPurNo: $('.form-text-FPurNo').val(),//工序号
                                FPurName: $('.form-text-FPurName').val(),//工序名称
                            }));
                        },
                        dataSrc: function (json) {
                            json.recordsFiltered = json.total;  // 总行数
                            json.recordsTotal = json.page; // 当前页数
                            return json.list;
                        },
                        error: function (xhr, status, error) {
                            toastr.error(xhr);
                        }
                    },
                    //"aLengthMenu": [10, 25, 50, 100, 500],
                    "columns": [
                        {
                            data: 'FProjectName',
                            title: '项目名称',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FNo',
                            title: '制号',
                            class: 'open-work-control2',
                        },
                        {
                            data: 'FPurNo',
                            title: '工序号',
                            class: 'open-work-control2',
                        },
                        {
                            data: 'FPurName',
                            title: '工序名称',
                            class: 'open-work-control2',
                        },
                        {
                            data: 'FKHDate1',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate1',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate1',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate2',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate2',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate2',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate3',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate3',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate3',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate4',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate4',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate4',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate5',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate5',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate5',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate6',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate6',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate6',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate7',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate7',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate7',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate8',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate8',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate8',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate9',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate9',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate9',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate10',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate10',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate10',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate11',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate11',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate11',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate12',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate12',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate12',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate13',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate13',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate13',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate14',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate14',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate14',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate15',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate15',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate15',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate16',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate16',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate16',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate17',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate17',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate17',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate18',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate18',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate18',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate19',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate19',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate19',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate20',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate20',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate20',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate21',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate21',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate21',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate22',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate22',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate22',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate23',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate23',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate23',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate24',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate24',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate24',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate25',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate25',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate25',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate26',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate26',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate26',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate27',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate27',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate27',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate28',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate28',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate28',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FKHDate29',
                            title: '客户计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FTZDate29',
                            title: '调整计划',
                            class: 'open-work-control2'
                        },
                        {
                            data: 'FSJDate29',
                            title: '实际完成',
                            class: 'open-work-control2'
                        },
                    ],
                    columnDefs: [
                        {
                            "targets": [4
                                , 5
                                , 6
                                , 7
                                , 8
                                , 9
                                , 10
                                , 11
                                , 12
                                , 13
                                , 14
                                , 15
                                , 16
                                , 17
                                , 18
                                , 19
                                , 20
                                , 21
                                , 22
                                , 23
                                , 24
                                , 25
                                , 26
                                , 27
                                , 28
                                , 29
                                , 30
                                , 31
                                , 32
                                , 33
                                , 34
                                , 35
                                , 36
                                , 37
                                , 38
                                , 39
                                , 40
                                , 41
                                , 42
                                , 43
                                , 44
                                , 45
                                , 46
                                , 47
                                , 48
                                , 49
                                , 50
                                , 51
                                , 52
                                , 53
                                , 54
                                , 55
                                , 56
                                , 57
                                , 58
                                , 59
                                , 60
                                , 61
                                , 62
                                , 63
                                , 64
                                , 65
                                , 66
                                , 67
                                , 68
                                , 69
                                , 70
                                , 71
                                , 72
                                , 73
                                , 74
                                , 75
                                , 76
                                , 77
                                , 78
                                , 79
                                , 80
                                , 81
                                , 82
                                , 83
                                , 84
                                , 85
                                , 86
                                , 87
                                , 88
                                , 89
                                , 90],
                            fnCreatedCell: function (cell, cellData, rowData, rowIndex, colIndex) {

                                var trow = null;
                                $(cell).click(function () {
                                    var htmls = '<input type="text" class="input-text" name="takeFSDate"  readonly="readonly"/>';
                                    htmls += ' <script>';
                                    htmls += '$(function () {';

                                    htmls += ' $("input[name=\'takeFSDate\']").daterangepicker({\n' +
                                        '                    singleDatePicker: true, // 设置为单日历，即无区间 默认false\n' +
                                        '                    showDropdowns: true, // 当设置值为true时，允许年份和月份通过下拉框的形式选择 默认false\n' +
                                        '                    autoUpdateInput: false, // 1.当设置为false的时候,不给与默认值(当前时间) 2.选择时间时,失去鼠标焦点,不会给与默认值 默认true\n' +
                                        '                    timePicker24Hour: true, // 设置小时为24小时制 默认false\n' +
                                        '                    timePicker: false, // 可选中时分 默认false\n' +
                                        '                    locale: {\n' +
                                        '                        format: "YYYY-MM-DD",\n' +
                                        '                        separator: " - ",\n' +
                                        '                        daysOfWeek: ["日", "一", "二", "三", "四", "五", "六"],\n' +
                                        '                        monthNames: ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"]\n' +
                                        '                    }\n' +
                                        '                }).on(\'apply.daterangepicker\', function (ev, picker) {\n' +
                                        '                    $("input[name=\'takeFSDate\']").val(picker.startDate.format(\'YYYY-MM-DD\'));\n' +
                                        '                });';
                                    htmls += ' });';
                                    htmls += "<\/script>";
                                    $(this).html(htmls);
                                    var aInput = $(this).find(":input");
                                    var newcellData = cellData.replace("<span>", "");
                                    newcellData = newcellData.replace("<span style=\"background-color:#FFC0CB;color: #0a001f\">", "");
                                    newcellData = newcellData.replace("<span style=\"background-color:#80FF02;color: #0a001f\">", "");
                                    newcellData = newcellData.replace("<\/span>", "");
                                    aInput.focus().val(newcellData);
                                    //在用户点击某一单元格的时候，获取当前单元格的信息（ trow ），以便后面修改和使用。
                                    trow = oTable.row($(this)).data();
                                });
                                $(cell).on("blur", ":input", function () {
                                    var text = $(this).val();
                                    $(cell).html(text);
                                    oTable.cell(cell).data(text);

                                    datajson = JSON.parse(JSON.stringify(trow));
                                    var newtext = text.replace("<span>", "");
                                    newtext = newtext.replace("<span style=\"background-color:#FFC0CB;color: #0a001f\">", "");
                                    newtext = newtext.replace("<span style=\"background-color:#80FF02;color: #0a001f\">", "");
                                    newtext = newtext.replace("<\/span>", "");
                                    if (newtext.length > 0) {

                                        $.ajax({
                                            type: 'POST',
                                            contentType: 'application/json',
                                            url: '/s/projectmjplan/addprojectmjplanjh', // 调用地址
                                            data: JSON.stringify({
                                                planid: datajson['key'],
                                                bosid: datajson['FBosID'],
                                                projectid: datajson['FProjectID'],
                                                newtext: newtext,
                                                colIndex: colIndex
                                            }),
                                            async: false,
                                            success: function (data) {
                                                if (data.result == 'success') {
                                                    $('#mainTable').DataTable().ajax.reload(null, false);
                                                } else if (data.result == 'error') {
                                                    toastr.error(data.error);
                                                }
                                            },
                                            error: function (e) {
                                                toastr.error(e.status);
                                                toastr.error(e.responseText);
                                            }
                                        });
                                    }

                                    //现在你就可以将获取到当前行的json发送到后台进行修改了
                                });
                            }
                        }
                    ],
                    scrollY: (document.body.clientHeight - 150) + 'px',
                    scrollX: true,
                    paging: true, // 是否开启本地分页
                    pageLength: 15, // 改变初始化页长度（每页多少条数据）
                    pagingType: 'full_numbers', // 首页，尾页，上一页和下一页四个按钮,加上数字按钮
                    lengthChange: false, // 是否允许因子改变表格每页显示的记录数
                    searching: false, // 是否允许Datatables开启本地搜索
                    ordering: true, // 是否允许Datatables开启排序
                    info: true, // 控制是否显示表格左下角的信息
                    language: DataTablesLanguage
                });
                // $('#mainTable').on('click', 'tbody td.Editor', function (e) { //在表格中对打上Editor标签的列才能开启行内编辑功能
                //     editor.inline(this, { onBlur: 'submit' });//在修改数据后点击任意处即可关闭表单保存修改后的数据
                // });


                // 查询按钮点击事件
                $('.btn-search-fun').on('click', function () {
                    $('#mainTable').DataTable().ajax.reload(null, false);
                });

            });

            function Values() {
                layer_show('录入模具计划', 'myprojectmojuplanedit.html?op=1&FProjectID=' + id, '800', '400');
            }

            function Daochu() {
                $('body').mLoading('show');
                setTimeout(function () {
                    $('.mloading-text').html('正在获取数据...');
                    setTimeout(function () {
                        $('.mloading-text').html('获取完成准备下载...');
                        setTimeout(function () {
                            window.location.href = "/getProjectMJPlanData?FProjectID=" + id + "&jmname=" + jmname;
                            $("body").mLoading("hide");
                        }, 1000);
                    }, 1000);
                }, 1000);
            }
        </script>
    </body>
</html>